LoggerService change log
========================

ВАЖНЫЕ ИЗМЕНЕНИЯ И ИСПРАВЛЕНИЯ
------------------------------

20211204:

  - Добавлена ссылка на родительский класс (parent) в custom-вызовах, v.1.50:

    > app.modules:
        loader
        order_check
        order_generate
        order_merge
        order_report
        unloader

  - Контроль блокировки дизайна, v.1.50: 
  
    > app.core.Loader:
        generate (self._forced_status)
    > app.statuses:
        STATUS_REJECTED_DISABLED = 222

    > ext\filetypes\postbank.py
    > ext\loader\postbank.py
        _get_parent
        _check_product_design
        incoming_custom
        incoming_individual_design_custom
        incoming_nspk_individual_design_custom
        incoming_X5_custom
        incoming_cyberlab_custom
    > ext\order_generate\postbank.py
        custom_step2 (local_IsPlasticDisabled)
        custom_step3 (batch_index)
    > ext\order_report\postbank.py
        delivery_report (local_IsPlasticDisabled)

20210909:

  - Транзакции обработки данных BankPerso (сбои в сети), v.1.42: 
  
    > app.core.Connection:
        connect
        checkFileExists
        getBody
        setBody
        updateBody
        updateReadyDate
        addNewOrder
    > app.core.AbstractOrderClass:
        on_before
        on_after
    > _SQL        

20210114:

  - Регистрировать только новые(пустые) отправления ПочтаРоссии: 

    > ext\filetypes\postbank.LOCAL_CHECK_POSTONLINE_FREE
    > ext\order_generate.postbank.custom_postonline

  - Повторно регистрировать только заданный тип карты:
  
    > ext\order_generate.postbank.unregister

20201230:

  - Исключить праздничные дни: 

    > ext\filetypes\postbank.local_GetDeliveryDate

20201229:

  - Проверка (отключение) сертификата безопасности SSL postonline.connect: IsCheckSSL (verify):

    > ext\postonline.py

20201228:

  - Дублирование имен отчетов CRDSRT. Имя файла для отчета сортировки:

    > ext\unloader.postbank.csv: filename, дата файла - today

20201225:

  - Отправка отчетности: контроль выгрузки Ф103: IsCheckF103Sent

    > ext\order_generate.postbank.change_delivery_date

  - Производственный календарь на 2021 год: ext.__init__.calendar

20200602:

  - регистрация почтовых отправлений EMS.

  - параметры конфигурации (WebPerso.Configurator):

    CASE_PACKAGE (транспортная упаковка):

    Значения тегов: C1-BE, C1-BE20, C1-BE50

    КЕЙС 1

    C1-BE:Транспортная упаковка: Доставка EMS - Пластиковый пакет
    C1-BE-20:Транспортная упаковка: Доставка EMS - Пакет размером 280х380+40 мм (максимально 20 пластиковых конвертов с картами, при общем количестве карт до 200 штук)
    C1-BE-50:Транспортная упаковка: Доставка EMS - Пакет размером 360х500+40 мм (максимально 50 пластиковых конвертов с картами, при общем количестве карт от 201 до 500 штук)

    КЕЙС 2

    C2-BE:Транспортная упаковка: Доставка EMS - Пластиковые пакеты размером: 280х380+40 мм; 360х500+40 мм - для упаковки неименных карт
    C2-BE:Гофрокороб: Гофрокороб. Размер: 245х275х260 мм - для упаковки неименных персонализированных карт

    > ext\filetypes\postbank.py
    > ext\order_generate\postbank.py (custom_step1, lines 374-400, # Материалы к упаковке, вложения)
    > ext\order_generate\postbank.py (custom_postonline, lines 890...)

    > ext\postonline.py ... unload > printOrderForms (Е-1, print_type: ['THERMO', 'PAPER'])

  - Именные без адресной доставки укладываются в упаковку 1-го уровня C65 (C1-A2):

    > config.postonline, добавить C1-A2(!) посылки

  - Онлайн-сервис Почта России. Выгрузка расширенного пакета документов на отгрузку:

    > ext\postonline.py, PochtaRuOnline: listOfBatch, unload, unload_documents

20200122:

  - регистрация отправлений ПочтаРоссии без нормализации:

    > ext\postonline.py, PochtaRuOnline.cleanAddress
    > ext\xmllib.py, clean_address

20191022:

  - интеграция с внешними приложениями (WebPerso), командый режим \app\modules\__init__.py:

    > core.py
    > app\modules\*.py
    > ext\postonline.py, PochtaRuOnline['change_send_date'], changePostOnline
    > ext\filetypes\postbank.py
    > ext\order_generate\postbank.py, change_delivery_date

  - сценарий ext\order_generate\__init__.py, (ключ 'auto'):  

    (1, 'PostBank_v1',
        [21, 0,],
        {
            'tags'   : everything,
            'custom' : postbank.change_delivery_date,
            'params' : {'date' : '23.10.2019', 'auto' : 1},
            'forced' : 220666,

            'change_status' : 0,
        },
    )

  - обработка ошибок (sdtout, stderr):

    > run.py
    > popen.py

20190114:

  - Банк ОТКРЫТИЕ, загрузчик персофайлов PM_PRS (r'PM_PRS_0001_.*\.xml')

    > ext\loader\otkrytie.py
    > ext\defaults\__init__.py

  - формат входящего файла FILE_FORMAT_PM_PRS (OpenWay)

    > core.Loader.generate
    > modules.__init__.py

20190111:

  - Банк ОТКРЫТИЕ, Предварительная обработка входящего персофайла

    > ext\preloader\__init__.py
    > ext\preloader\otkrytie.py

  - модуль предобработки PRELOADER

    > core.Preloader
    > core.AbstractPreloaderClass
    > modules.preloader
    > types\datatypes.py
    > types\filetypes.py
    
    > checker.py тип данных: DATA_TYPE_TEXT_A
    > srvlib.py [SRV_Outgoing]
    > xmllib.py [FMT_GetChildren]

  - Банк ОТКРЫТИЕ, тип файла FILETYPE_OTKRYTIE_V1

    > ext\filetypes\otkrytie.py

ВЕРСИИ
------

# 1.30: 

  - Интеграция с WebPerso.

# 1.22: 

  - Production application release.
